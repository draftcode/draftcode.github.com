=====================================
配列はCovariantなので使ってはいけない
=====================================
:Author: draftcode
:Date:   2012-01-01
:category: Java
:Slug:   182705

結論
====

配列はアレなので使ってはいけない。

Javaの配列とは
==============

Javaの配列はcovariantです。 ``Integer`` は ``Number`` のサブクラスなんだから、
``Integer[]`` も ``Number[]`` のサブクラスだ、というのがcovariantです。なので
次のようなことが出来てしまいます。

.. image:: images/20120101171202.png

見た目の型は ``Number`` の配列なのに、代入できる要素は ``Integerの`` 要素のみ
という配列が作れます。ここで、 ``Integer`` 以外の要素を代入しようとすると、同
じ ``Number`` を継承している ``Long`` でも実行時エラーになります。このときの
``Number`` の配列の実体は、 ``Integer`` の配列ですから。

配列は使ってはいけない
======================

`先の記事`_ とあわせて、配列は使ってはいけない。

.. _`先の記事`: http://draftcode.github.com/2012/01/01/182300.html

