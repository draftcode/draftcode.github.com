<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>draftcode.github.com</title>
    <meta name="description" content="">
    <meta name="author" content="draftcode">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src=".././theme/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href=".././theme/bootstrap.min.css" rel="stylesheet">
    <link href=".././theme/bootstrap.min.responsive.css" rel="stylesheet">
    <link href=".././theme/local.css" rel="stylesheet">
    <link href=".././theme/pygments.css" rel="stylesheet">
    <link rel="alternate" type="application/atom+xml" title="Atom" href=".././atom.xml">

</head>

<body>

<div class="navbar">
    <div class="navbar-inner">
    <div class="container">

         <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
         </a>

        <a class="brand" href="../.">draftcode.github.com</a>

        <div class="nav-collapse">
        <ul class="nav">
        
            
        
        
        
        </ul>
        </div>
        
    </div>
    </div>
</div>

<div class="container">
    <div class="content">
    <div class="row">

        <div class="offset2 span7">
                


        




    <div class='article'>
        <div class="content-title">
            <a href=".././2012/02/06/235454.html"><h1>HomebrewでクロスコンパイルできるGCCをビルドする</h1></a>
            06 Feb 2012


by <a class="url fn" href=".././author/draftcode.html">draftcode</a>
 



 
        </div>
        
        <div><p>Mac OS X 10.7.2 の Intel Core i7 を乗っけているMacbook Airで、Homebrewをつかってクロスコンパイラをビルドします。</p>
<div class="section" id="id1">
<h2>結論</h2>
<p><a class="reference external" href="https://gist.github.com/1751385">https://gist.github.com/1751385</a>のようなFormulaをつくればできます。このFormulaは<a class="reference external" href="http://pdos.csail.mit.edu/6.828/2011/xv6.html">http://pdos.csail.mit.edu/6.828/2011/xv6.html</a>をビルドするために、<a class="reference external" href="http://pdos.csail.mit.edu/6.828/2011/tools.html">http://pdos.csail.mit.edu/6.828/2011/tools.html</a>の設定を参考にして書きました。</p>
</div>
<div class="section" id="id2">
<h2>クロスコンパイラ……ぐぬぬ……</h2>
<p>クロスコンパイラは、以前自分が某研究室で作っているMIPSライクなCPUを使ったマシンで動くアセンブラを書いたときにもビルドしたのですが、なぜか動かなかったりします。なんか検索してみると、動かない動かないと言っている人も結構いたりするので失敗しやすいのでしょう。今回は無事動くところまでこぎ着けました。</p>
</div>
<div class="section" id="homebrew">
<h2>Homebrewでビルドするときの問題点</h2>
<p>Homebrewは既にパッケージとして用意してくれているものについてはビルドしない方針なので、GCCをビルドしたりするFormulaはありません。なので適当にでっち上げる必要があります。いろいろな人が既にGCCのFormulaを書いているので、それを参考に書けば良いのですが、適当にクロスコンパイラのFormulaを書くと失敗します。</p>
<p>GCCはコンパイルをした後に、binutilsを使ってバイナリをはき出します。なので、クロスコンパイルができるGCCをビルドするには、そのターゲットとなるプラットフォーム用のbinutilsが必要です。そのbinutilsのツールを探すのに、GCCはいろいろな場所をみてくれます。どこを探すかは<a class="reference external" href="http://gcc.gnu.org/install/configure.html#with-as">http://gcc.gnu.org/install/configure.html#with-as</a>に書いてあって、どうも
i386-foo-bar-asというのをPATHをみて探してくれるようです。適当にbinutilsとGCCで同じTargetを指定すれば良さそうなかんじ。</p>
<p>が、駄目。動きません。GCCのビルドは成功するのですが、そのGCCでなんかコンパイルしようとすると、どうもアセンブラがエラーを吐いているようです。実行されているコマンドを見てみると、システム組み込みのasを使っているようです。そりゃ駄目だ。</p>
<p>こんなの絶対おかしいよ。ということで、GCCのソースを見てみることに。いろいろかけずり回った結果、<tt class="docutils literal">gcc/gcc.c</tt>の<tt class="docutils literal">find_a_file()</tt>あたりでファイルを探しているようなのですが、なんかi386-foo-barみたいなマシンターゲットをつけているようには見えないぞ。あやしい。ちなみにldのほうは<tt class="docutils literal">gcc/collect2.c</tt>の<tt class="docutils literal">main</tt>でそういうプレフィックスをつけていて、ファイルを探すのもasとは別のコードで行っている模様。</p>
<p>どうも、ldについてはインストールマニュアルに書かれている通りに探してくれているみたいですが、asについてはなんか違うようです。</p>
</div>
<div class="section" id="id3">
<h2>解決</h2>
<p>GCCが正しいアセンブラを探してくれない。仕方がないので手動でアセンブラを指定することになります。ということで、<a class="reference external" href="https://gist.github.com/1751385#file_gcc_xv6.rb">https://gist.github.com/1751385#file_gcc_xv6.rb</a>のように汚い感じですが、アセンブラのパスを手動で指定してあげるようにします。このようにすると、うまくコンパイルができました。(ということは、ldについてはきちんと探してくれたようです……)</p>
<p>もし、Xv6をコンパイルして動かしたい。しかも、Homebrewで必要なものをいれたい。ということであれば、次のようにすることでうまくインストールすることができます。
QEMUはuse-gccを使わないとうまく動きませんでした:</p>
<div class="highlight"><pre>brew install https://raw.github.com/gist/1751385/binutils_xv6.rb
brew install https://raw.github.com/gist/1751385/gcc_xv6.rb
brew install https://raw.github.com/gist/1751385/gdb_xv6.rb
brew install qemu --use-gcc
</pre></div>
</div>
</div>
        <hr />
    </div>
		
    


 

        


 

    <div class='article'>
        <a href=".././2011/03/22/3b44376e-546d-11e0-9e76-d8a25efffee9.html"><h2>Writing Adblock Plus filters -- 日本語訳</h2></a>
        <div class= "well small"> 22 Mar 2011


by <a class="url fn" href=".././author/draftcode.html">draftcode</a>
 



 </div>
        <div class="summary"><p><a class="reference external" href="http://adblockplus.org/en/filters">Writing Adblock Plus filters</a>の和訳．ないっぽいので．元の文章のライセンスとかわからぬ．直訳しようと思ったらうまく訳せなくて意訳になってしまっている部分もあったり．途中から面倒くさくなったので，適当な訳になってたり．</p>
<p>あと，どうもURLとかフィルタルールが入っている関係で，レイアウトがすごくぐちゃぐちゃになります．それに加えて訳がいまいちなので，さらに読みづらい．超訳でもすればよかった……</p>
<p>Adblock Plusの新しいバージョンでは，さまざまなほうほうでフィルタを「いじる」ことができるようになっています．ここでは，その方法と使い方について説明しています．</p>
<p>免責事項: 例としてあげられているフィルタは，すべて単なる例として挙げており，使われることを意図しておりません．</p>
<div class="section" id="introduction-to-adblock-plus-filters">
<h2>Introduction to Adblock Plus filters</h2>
<p>この章では，ときどきフィルタを書くようなユーザーにとって十分な方法を説明します．</p>
<div class="section" id="basic-filter-rules">
<h3>Basic filter rules</h3>
<p>一番平凡なフィルタはブロックしたいバナーのアドレスを定義することでしょう．しかしながら，こういったアドレスはページを開く度に変わってしまうのがしばしばです．たとえば，<tt class="docutils literal"><span class="pre">http://example.com/ads/banner123.gif</span></tt>というアドレスで，<tt class="docutils literal">123</tt>の部分がランダムな数字であるようなものを考えてみましょう ...</p></div></div> <a class="btn btn-info xsmall" href=".././2011/03/22/3b44376e-546d-11e0-9e76-d8a25efffee9.html">read more</a></div>
    </div>	
				
    

 

        


 

    <div class='article'>
        <a href=".././2011/03/14/42aa3a98-4e10-11e0-bcea-d8a25efffee9.html"><h2>Macを大きいディスプレイにつなげるときはMini DisplayPort &lt;-&gt; DisplayPort変換ケーブルを使う</h2></a>
        <div class= "well small"> 14 Mar 2011


by <a class="url fn" href=".././author/draftcode.html">draftcode</a>
 



 </div>
        <div class="summary"><p>Macbook Proを修理に出したときに，どうしてもレポートを書かなければいけない感じだったので，Mac miniを購入しました．Macbook Proは3年ぐらい前のモデルだったので，大きいDVIポートがあり，DELLのU2711のような大きいディスプレイでも直接接続して最適な解像度が出せたのですが，今のMacについているようなMini DisplayPortだと，DVIとの変換ケーブルを使っても，フルHD程度までしか出力することができません．これはDVIのシングルリンクとかデュアルリンクとかの問題らしいんですが，それを解決するためにはAppleの高いデュアルリンク対応の変換アダプタを購入しなければいけません．</p>
<p>もっとシンプルな解決方法を目指します．最近のディスプレイはDisplayPortがついているようなので，それに変換すれば良いのです．実際自分はMini DisplayPortとDisplayPortの変換ケーブルを使って，大きい解像度の出力ができるようになっています．</p>
<p>残念ながら，このような変換ケーブルはあまり製造されていないようです．自分は<a class="reference external" href="http://store.shopping.yahoo.co.jp/ats/0203.html">ATS Direct</a>というサイトで購入しました．</p>
<p>またDisplayPortは音声出力も対応しているので，U2711の音声出力から音を出すこともできています．しかしながらU2711側では音量調節ができないので，音量調節ができるようなもの(スピーカーなど)でないと，音が大きすぎて耳がつぶれます．ヘッドホンとかは難しいです．ちなみに出力切り替えはSoundflowerを使うと便利です．</p>
<div class="section" id="id1">
<h2>追記 (2011-06-22)</h2>
<p>どうも探し方が悪かったようで，他にもいくつか見つかりました．</p>
<ul class="simple">
<li><a class="reference external" href="http://www.amazon.co.jp/dp/B004KB5HM6/">http://www.amazon.co.jp/dp/B004KB5HM6/</a></li>
<li><a class="reference external" href="http://www.amazon.co.jp/dp/B004GCHNP8/">http://www.amazon ...</a></li></ul></div> <a class="btn btn-info xsmall" href=".././2011/03/14/42aa3a98-4e10-11e0-bcea-d8a25efffee9.html">read more</a></div>
    </div>	
				
    

 

        


 

    <div class='article'>
        <a href=".././2010/08/15/accumulator_programming.html"><h2>アキュムレータについて</h2></a>
        <div class= "well small"> 15 Aug 2010


by <a class="url fn" href=".././author/draftcode.html">draftcode</a>
 



 </div>
        <div class="summary"><p>コンピュータプログラミングの概念・技法・モデルの中で，アキュムレータという概念が出てきました．たぶん，いろいろなところで使ってきた手法を，一般化して名前をつけたため，違うモノのように見えるだけだと思うのですが，混乱しているので整理します．</p>
<div class="section" id="id2">
<h2>再帰計算と反復計算</h2>
<p>宣言的プログラミングにおいては，単純に再帰関数を書いてしまうと効率が悪いことが多いので，現実的には再帰計算の特殊な場合である，反復計算になるようにプログラムを書きます．再帰的データ構造を扱う再帰計算を反復計算にするにあたっては，問題を状態変換の列に作り直す必要がありました．</p>
<p>通常の場合，再帰形を書かずにに反復形を書くことが多いです．その場合に用いられる形式として，アキュムレータプログラミングという形式があります．</p>
</div>
<div class="section" id="id3">
<h2>反復計算におけるアキュムレータ</h2>
<p>反復計算は次のような制御抽象として表現できました:</p>
<div class="highlight"><pre>proc {Iterate S IsDone Transform ?R}
    if {IsDone S} then R = S
    else S1 in
        S1 = {Transform S}
        {Iterate S1 IsDone Transform R}
    end
end
</pre></div>
<p>アキュムレータは入力と出力の状態の対になります．この場合において，<tt class="docutils literal">S ...</tt></p></div> <a class="btn btn-info xsmall" href=".././2010/08/15/accumulator_programming.html">read more</a></div>
    </div>	
				
    

 

        


 

    <div class='article'>
        <a href=".././2010/08/15/learning_path.html"><h2>情報工学科に所属する前後の学習の道筋</h2></a>
        <div class= "well small"> 15 Aug 2010


by <a class="url fn" href=".././author/draftcode.html">draftcode</a>
 



 </div>
        <div class="summary"><p>自分も現在学習途中であるし，これはこのように勉強しろというようなたいそうなことは言えないのですが，どういうことを思って，どういう勉強を進めてきたかということを書いてみたいと思います．</p>
<div class="section" id="id2">
<h2>計算機プログラムの構造と解釈を読み始めた</h2>
<p>買ったのは浪人をすることに決めたときでした．そこから4月か5月ぐらいまではやっていたような気がしますが，大して進まずに放置しました．実際に割と進んだのはB2のときでした．ちなみに現在も止まったままです．きっと多くの人が有名な本だし読んでおこうと思いつつも止まっているのではないでしょうか．自分もその一人です．</p>
</div>
<div class="section" id="c">
<h2>プログラミング言語Cを読んだ</h2>
<p>読み始めたのはB1の5月からでした．以前にもCの特に有用ではなさそうな本を読みましたが，情報工学科を志望しているのだしCぐらいできていてもいいのではないだろうかということでこの本だったと思います．この本については演習を含めてだいたい1ヶ月か2ヶ月ぐらいで読み終えたと思います．</p>
</div>
<div class="section" id="id3">
<h2>Cを使うアルバイトを始めた</h2>
<p>プログラミング言語Cを読み終えたので，Cを使うアルバイトをはじめました．現在ではそういうバイトは少なくなっているのかもしれないですが，たまたま見つけたのでそこに応募しました．現在も一応続けています．</p>
</div>
<div class="section" id="mfc">
<h2>MFCに触れた</h2>
<p>アルバイトの研修の最初の方は基本的なCの演習でしたが，後半の方はMFCを使った
Windowsアプリケーションの開発でしたので，MFCに触れることになりました．必然的にC++も触れることになっています．MFCを使うにあたってリファレンスを参照するので，
MSDNをひいていたりしました．</p>
</div>
<div class="section" id="id4">
<h2>プログラミング言語C++を読み始めた</h2>
<p>MFCはC++のフレームワークですので，C++の知識が必要になると思い，プログラミング言語C++を購入しました．この本に関しては評判はイマイチでしたが，言語をデザインした人が書いた本だからという理由で購入しました．</p>
<p>この本はまだ途中までしか読んでいないですし，読んだ部分もほぼ覚えていません．というのも，アルバイトの中で実際に使っているのはC++というよりBetter Cでしたので，C++の様々な機能 ...</p></div> <a class="btn btn-info xsmall" href=".././2010/08/15/learning_path.html">read more</a></div>
    </div>	
				
    
        <div class="pagination">
<ul>

    <li class="prev disabled"><a href="#">&larr; Previous</a></li>



    <li class="active"><a href=".././category/misc.html">1</a></li>



    <li class="next disabled"><a href="#">&rarr; Next</a></li>


</ul>
</div>
    

 

 
 


        </div>
        
        <div class="span3">

            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Site
                </li>
            
                <li><a href=".././archives.html">Archives</a>
                <li><a href=".././atom.xml" rel="alternate">Atom feed</a></li>
                
            </ul>
            </div>


            
            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Categories
                </li>
                
                
                <li><a href=".././category/Python.html">Python</a></li>
                
                <li><a href=".././category/misc.html">misc</a></li>
                
                <li><a href=".././category/Java.html">Java</a></li>
                                   
            </ul>
            </div>
            


            


            
            <div class="social">
            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Social
                </li>
           
                
                <li><a href="http://twitter.com/#!/draftcode">twitter</a></li>
                
                <li><a href="http://github.com/draftcode">github</a></li>
                
            </ul>
            </div>
            </div>
            

        </div>  
    </div> 
    </div> 

<footer>
<br />
<p><a href="../.">draftcode.github.com</a> &copy; draftcode 2012</p>
</footer>

</div> <!-- /container -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-collapse.js"></script>


<a href="http://github.com/draftcode/"><img style="position: absolute; top: 40px; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png" alt="Fork me on GitHub" /></a>
 
</body>
</html>