<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible'>
    <title>配列はCovariantなので使ってはいけない</title>
    <meta content='draftcode' name='author'>
    <meta content='3T_u3CXt1yC2LeNvWOzsMSPQrs_0Ek-XUnA8DYgu7zY' name='google-site-verification'>
    <link href='/stylesheets/old.css' rel='stylesheet'>
    <link href='http://fonts.googleapis.com/css?family=Droid+Sans:400,700|Economica' rel='stylesheet' type='text/css'>
  </head>
  <body>
    <div id='content'>
      <div id='article'>
  <div id='content_title'>
    <h1>配列はCovariantなので使ってはいけない</h1>
  </div>
  <div id='posted_date'>
    Posted on 2012-01-01
  </div>
  <div id='content_body'>
    <h2>結論</h2>
<p>配列はアレなので使ってはいけない。</p>
<h2>Javaの配列とは</h2>
<p>Javaの配列はcovariantです。 <code>Integer</code> は <code>Number</code> のサブクラスなんだから、<code>Integer[]</code> も <code>Number[]</code> のサブクラスだ、というのがcovariantです。なので次のようなことが出来てしまいます。</p>

<p><img src="/2012/01/01/20120101171202.png" alt=""></p>

<p>見た目の型は <code>Number</code> の配列なのに、代入できる要素は <code>Integerの</code> 要素のみという配列が作れます。ここで、 <code>Integer</code> 以外の要素を代入しようとすると、同じ <code>Number</code> を継承している <code>Long</code> でも実行時エラーになります。このときの<code>Number</code> の配列の実体は、 <code>Integer</code> の配列ですから。</p>
<h2>配列は使ってはいけない</h2>
<p><a href="/2012/01/01/182300.html">先の記事</a> とあわせて、配列は使ってはいけない。</p>

  </div>
</div>

    </div>
    <div id='disclaimer'>
      Disclaimer: The opinions stated here are my own, not necessarily those of my company.
    </div>
  </body>
</html>
